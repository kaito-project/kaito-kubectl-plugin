version: 2
before:
  hooks:
    - go mod tidy

builds:
  - id: kaito-kubectl-plugin
    main: ./cmd/kubectl-kaito
    binary: bin/kubectl-kaito
    env:
      - CGO_ENABLED=0
      - GO111MODULE=on
    goos:
      - linux
      - windows
      - darwin
    goarch:
      - amd64
      - arm64
    # Exclude Windows ARM64 as it's not commonly used
    ignore:
      - goos: windows
        goarch: arm64
    ldflags:
      - -s -w
      - -X {{.ModulePath}}/pkg/cmd.version={{.Version}}
      - -X {{.ModulePath}}/pkg/cmd.commit={{.Commit}}
      - -X {{.ModulePath}}/pkg/cmd.date={{.Date}}

archives:
  - name_template: >-
      {{ .ProjectName }}-{{ .Version }}-
      {{- .Os }}-
      {{- if eq .Arch "amd64" }}amd64
      {{- else if eq .Arch "386" }}i386
      {{- else }}{{ .Arch }}{{ end }}
      {{- if .Arm }}v{{ .Arm }}{{ end }}
    files:
      - LICENSE

changelog:
  groups:
    - title: Features ğŸŒˆ
      regexp: ^.*feat[(\\w)]*:+.*$
    - title: Bug Fixes ğŸ
      regexp: ^.*fix[(\\w)]*:+.*$
    - title: Code Refactoring ğŸ’
      regexp: ^.*refactor[(\\w)]*:+.*$
    - title: Code Style ğŸ¶
      regexp: ^.*style[(\\w)]*:+.*$
    - title: Continuous Integration ğŸ’œ
      regexp: ^.*ci[(\\w)]*:+.*$
    - title: Documentation ğŸ“˜
      regexp: ^.*docs[(\\w)]*:+.*$
    - title: Maintenance ğŸ”§
      regexp: ^.*chore[(\\w)]*:+.*$
    - title: Performance Improvements ğŸš€
      regexp: ^.*perf[(\\w)]*:+.*$
    - title: Revert Change â—€ï¸
      regexp: ^.*revert[(\\w)]*:+.*$
    - title: Security Fix ğŸ›¡ï¸
      regexp: ^.*security[(\\w)]*:+.*$
    - title: Testing ğŸ’š
      regexp: ^.*test[(\\w)]*:+.*$

release:
  prerelease: auto
  make_latest: true
  header: |
    ## kubectl kaito Plugin {{ .Tag }}  - {{ time "2006-01-02" }}
